<script>
    if (!sessionStorage.getItem('employee')) {
        document.body.innerHTML = '<h2 class="text-center text-danger mt-5">Access denied. Employee login required.</h2><a href="/" class="btn btn-primary d-block mx-auto mt-3">Go to Home</a>';
    }
</script>

<h1 class="text-center">Bartender Queue</h1>
<div class="row">
    <div class="col-md-12 text-center mb-4">
        <h3 class="text-white">Welcome, <span id="employeeName"></span></h3>
        <button id="logoutBtn" class="btn btn-danger">Logout</button>
    </div>
</div>
<div class="row">
    <div class="col-md-6">
        <h2 class="text-white">Pending</h2>
        <ul class="list-group">
            {{#each pendingOrders}}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{client_name}}</strong>: {{drink_name }} x {{quantity}} &nbsp; {{maker}}
                </div>
                <form action="/bartender/update-status/" method="POST" class="d-inline">
                    <input type="hidden" name="orderId" value="{{order_id}}">
                    <input type="hidden" name="newStatus" value="in-progress">
                    <input type="hidden" name="employeeId" value="101">
                    <button type="submit" class="btn btn-warning btn-sm">Start</button>
                </form>
            </li>
            {{/each}}
        </ul>
    </div>
    <div class="col-md-6">
        <h2 class="text-white">In Progress</h2>
        <ul class="list-group">
            {{#each inProgressOrders}}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{client_name}}</strong>: {{drink_name }} x {{quantity}}
                </div>
                <form action="/bartender/update-status/" method="POST" class="d-inline">
                    <input type="hidden" name="orderId" value="{{order_id}}">
                    <input type="hidden" name="newStatus" value="pending">
                    <input type="hidden" name="employeeId" value="101">
                    <button type="submit" class="btn btn-warning btn-sm">false alarm</button>
                </form>
                <form action="/bartender/update-status/" method="POST" class="d-inline">
                    <input type="hidden" name="orderId" value="{{order_id}}">
                    <input type="hidden" name="newStatus" value="completed">
                    <input type="hidden" name="employeeId" value="101">
                    <button type="submit" class="btn btn-success btn-sm">fulfill</button>
                </form>
            </li>
            {{/each}}
        </ul>
    </div>
    <div >
        <h2 class="text-white">Completed</h2>
        <ul class="list-group">
            {{#each completedOrders}}
            <li class="list-group-item list-group-item-success">
                <div><strong>{{client_name}}</strong>: {{drink_name }} x {{quantity}}</div>
                <form action="/bartender/update-status/" method="POST" class="d-inline">
                    <input type="hidden" name="orderId" value="{{order_id}}">
                    <input type="hidden" name="newStatus" value="in-progress">
                    <input type="hidden" name="employeeId" value="101">
                    <button type="submit" class="btn btn-success btn-sm">Unfulfill</button>
                </form>
            </li>
            {{/each}}
        </ul>
    </div>
</div>
<script>
    document.getElementById('logoutBtn').addEventListener('click', function() {
        sessionStorage.removeItem('employee');
        window.location.href = '/';
    });

    document.addEventListener('DOMContentLoaded', function() {
        const employee = JSON.parse(sessionStorage.getItem('employee'));
        if (employee) {
            document.getElementById('employeeName').textContent = employee.name;
        }
    });
</script>